
<div class="row">
     <div class="col-md-3">
        <div class="card animated fadeIn">
            <div class="p-20">
                 <pre>
                    {{forma.value | json}}
                </pre>
            </div>
      </div>
    </div>
    <div class="col-md-9">
        <div class="card animated fadeIn">
            <form [formGroup]="forma" (ngSubmit)="guardarUsuario()" >
                <aw-wizard #wizard [navBarLayout]="'large-empty-symbols'">
                  <aw-wizard-step [stepTitle]="'Datos Personales'" >
                      <ng-template awWizardStepSymbol><i class="fas fa-id-card"></i></ng-template>
                      <div class="form-group p-10">
                      <h2 class="p-10" >LLENAR TODOS LOS DATOS DEL CHOFER</h2>
                      <div class="container-form">
                        <div class="item item-form-6">
                          <h5>Nombre (s): <span class="text-danger">*</span></h5>
                          <input type="text" name="text" formControlName="nombre" (input)="capitalizaCamelCase($event.target.value, 'nombre')" placeholder="Ejemplo: Juan" class="form-control" required>
                          <p class="field-requiered"
                          *ngIf="forma.controls['nombre'].errors?.required && VALIDATIONS_STEP1.nombre">Campo requerido*</p>
                        </div>
                        <div class="item item-form-6">
                          <h5>Apellidos: <span class="text-danger">*</span></h5>
                          <input type="text" name="text" formControlName="apellidos" (input)="capitalizaCamelCase($event.target.value, 'apellidos')" placeholder="Ejemplo: Hernández López" class="form-control" required>
                          <p class="field-requiered"
                          *ngIf="forma.controls['apellidos'].errors?.required && VALIDATIONS_STEP1.apellidos">Campo requerido*</p>
                        </div>
                      </div>
                      <div class="container-form">
                        <div class="item item-form-6">
                            <h5>Correo eléctronico: <span class="text-danger">*</span></h5>
                            <input type="text" name="text" formControlName="correo" placeholder="Ejemplo: juan-39@gmail.com" class="form-control" required>
                            <p class="field-requiered"
                            *ngIf="forma.controls['correo'].errors?.required && VALIDATIONS_STEP1.correo">Campo requerido*</p>
                            <p class="field-requiered"
                            *ngIf="forma.controls['correo'].errors?.pattern && forma.controls['correo'].value">Formato de correo incorrecto*</p>
                        </div>
                        <div class="item item-form-6">
                            <h5>Teléfono: <span class="text-danger">*</span></h5>
                            <input type="text" formControlName="telefono" name="text" class="form-control" mask="(000) 000-0000" prefix="+52" [showMaskTyped] = "true" required>
                            <span class="font-13 text-muted">Ejemplo: +52(987) 118-9232</span>
                            <p class="field-requiered"
                            *ngIf="forma.controls['telefono'].errors?.required && VALIDATIONS_STEP1.telefono">Campo requerido*</p>
                            <p class="field-requiered"
                            *ngIf="forma.controls['telefono'].errors?.minlength && forma.controls['telefono'].value">Se requieren 10 digitos*</p>
                        </div>
                      </div>
                      <div class="container-form">
                        <div class="item item-form-6">
                            <h5>Fecha de nacimiento: <span class="text-danger">*</span></h5>
                            <div class="col-12 d-flex p-0">
                              <div class="col-11" >
                                  <input class="form-control" placeholder="Día Mes, Año"
                                  [minDate]="minDate"
                                  [maxDate] ="maxDate"
                                  [startDate]="startDate"
                                  name="dp" formControlName="fechaNacimiento" #fechaNacimiento
                                  ngbDatepicker #d="ngbDatepicker">
                              </div>
                              <div>
                                  <button class="btn btn-outline-secondary" (click)="d.toggle()" type="button"><i class="far fa-calendar-alt"></i></button>
                              </div>
                            </div>
                            <p class="field-requiered"
                            *ngIf="forma.controls['fechaNacimiento'].errors?.ngbDate && forma.controls['fechaNacimiento'].value">Formato de fecha incorrecto*</p>
                            <p class="field-requiered"
                            *ngIf="forma.controls['fechaNacimiento'].errors?.required  && VALIDATIONS_STEP1.fechaNacimiento">Campo requerido*</p>

                          <div class="item mt-5">
                              <h5>Género: <span class="text-danger">*</span></h5>
                              <div class="form-check">
                                  <label class="custom-control custom-radio">
                                      <input id="radio1" name="genero" type="radio" class="custom-control-input"  value="1" formControlName="genero" >
                                      <span class="custom-control-indicator"></span>
                                      <span class="custom-control-description">Hombre</span>
                                  </label>
                                  <label class="custom-control custom-radio">
                                      <input id="radio2" name="genero" type="radio" class="custom-control-input"  value="0" formControlName="genero" >
                                      <span class="custom-control-indicator"></span>
                                      <span class="custom-control-description">Mujer</span>
                                  </label>
                              </div>
                          </div>
                        </div>
                        <div class="item item-form-6">
                            <h5>Selecciona la foto del chofer: <span class="text-danger">*</span></h5>
                            <input type="file" accept="image/*" placeholder="" (change)="upload($event)"  class="form-control" formControlName="img" >
                            <img id="blah" [src]="imageSrc || '../../../assets/images/user.png'  " alt="your image" class="img-profile-chofer"/>
                            <p class="field-requiered"
                            *ngIf="forma.controls['img'].errors?.required  && VALIDATIONS_STEP1.img">Seleccione la foto del chofer*</p>
                        </div>
                      </div>
                      <button type="button" class="btn btn-info btn-wizard-btn-next-step" *ngIf="!revisionStep1"  (click)="paso1()">Validar</button>
                      <button  *ngIf="revisionStep1" type="button" class="btn btn-info btn-wizard-btn-next-step"   awNextStep>Continuar</button>
                      </div>
                  </aw-wizard-step>
                  <aw-wizard-step [stepTitle]="'Relación de concesiones'" >
                      <ng-template awWizardStepSymbol><i class="fas fa-briefcase"></i></ng-template>
                    <div class="form-group p-10">
                        <h2 class="p-10" >REGISTRO DE CONCESIONES</h2>
                      <div class="col-12 d-flex" >
                        <div class="col-6">
                            <div class="container-form">
                              <div class="item item-form-3 col-12 pl-0">
                                <h5>Folio de Chofer: <span class="text-danger">*</span></h5>
                                <input type="text" name="text" formControlName="folio" placeholder="Ejemplo: 210283" class="form-control" required>
                                <p class="field-requiered"
                                *ngIf="forma.controls['folio'].errors?.required && VALIDATIONS_STEP2.folio">Campo requerido*</p>
                              </div>
                            </div>
                            <div class="container-form">
                                <div class="item item-form-3 col-12 pl-0">
                                    <h5>Socio o Ayudante?: <span class="text-danger">*</span></h5>
                                    <select class="form-control custom-select"
                                     formControlName="etiqueta">
                                        <option value="">Seleccione tipo de chofer</option>
                                        <option value="1">Socio</option>
                                        <option value="0">Ayudante</option>
                                    </select>
                                    <p class="field-requiered"
                                    *ngIf="forma.controls['etiqueta'].errors?.required && VALIDATIONS_STEP2.etiqueta">Campo requerido*</p>
                                </div>
                            </div>
                            <div class="container-form">
                                <div class="item item-form-3 col-12 pl-0">
                                    <div  class="container-concesiones-ayudante" >
                                        <div *ngFor="let item of forma.controls['concesiones']['controls']; let i = index;">
                                            <app-formulario-concesiones
                                            *ngIf="forma.controls['concesiones']['controls'][i]['controls']['tipo'].value == 'Socio'"
                                            [forma]="forma"
                                            [i]="i"
                                            [tipo]="forma.controls['concesiones']['controls'][i]['controls']['tipo'].value"
                                            > </app-formulario-concesiones>
                                      </div>
                                    </div>
                                </div>
                            </div>
                            <div class="container-form">
                                <div class="item item-form-3">
                                    <input type="checkbox" id="propietario" formControlName="propietarioVehiculo"/>
                                    <label for="propietario">Soy propietario de un vehículo</label>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="item">
                                <div  class="container-concesiones-ayudante" >
                                    <div *ngFor="let item of forma.controls['concesiones']['controls']; let i = index;" >
                                        <app-formulario-concesiones
                                        *ngIf="forma.controls['concesiones']['controls'][i]['controls']['tipo'].value == 'Ayudante'"
                                        [forma]="forma"
                                        [i]="i"
                                        [tipo]="forma.controls['concesiones']['controls'][i]['controls']['tipo'].value"
                                        (crear)="_createArrayControls()"
                                        (borrar)="_removeArrayControls($event)"
                                        > </app-formulario-concesiones>
                                  </div>
                                </div>
                                <div class="message-max-concesiones">
                                    <p>  {{ error }}</p>
                                </div>
                            </div>
                        </div>
                      </div>


                      <div class="btn-wizard-btn-next-step">
                        <button type="button" class="btn btn-warning btn-regresar"
                        awPreviousStep>Regresar</button>
                        <button type="button" class="btn btn-info"
                        *ngIf="!revisionStep2"  (click)="paso2()">Validar</button>
                        <button type="button" class="btn btn-info"
                        *ngIf="revisionStep2"  awNextStep>Siguiente</button>

                        <!-- <button type="button" class="btn btn-outline-info"
                         *ngIf="!forma.value.propietarioVehiculo"
                         [awGoToStep]="{ stepIndex: 3 }">Finalizar</button> -->


                      </div>


                      </div>
                  </aw-wizard-step>
                  <aw-wizard-step [stepTitle]="'Relación con vehículos'" >
                      <ng-template awWizardStepSymbol><i class="fas fa-car"></i></ng-template>
                      <div class="form-group p-10">
                        <!-- <div  *ngIf="forma.value.propietarioVehiculo"> -->
                        <div *ngIf="forma.controls['concesiones']['controls'][0]['controls']['placa'].value" >
                            <div *ngFor="let item of forma.controls['vehiculos']['controls']; let i = index;"  >
                              {{ forma.controls['concesiones']['controls'][i]['controls']['placa'].value }}

                               <app-formulario-vehiculos
                               [forma]="forma"  [i]="i"></app-formulario-vehiculos>
                            </div>
                        </div>
                        <div class="btn-wizard-btn-next-step">
                          <button type="button" class="btn btn-outline-warning btn-regresar"
                           awPreviousStep>Regresar</button>

                           <button type="button" class="btn btn-outline-info"
                           awNextStep>Siguiente</button>
                        </div>
                      </div>
                  </aw-wizard-step>
                  <aw-wizard-step [stepTitle]="'Finalizar'">
                      <ng-template awWizardStepSymbol><i class="far fa-check-circle"></i></ng-template>
                      <h2 class="p-10" >RESUMEN PREVIO  </h2>
                    <!-- <li>imprimir usuario administrador que dio de alta el chofer</li> -->
                    {{ respuesta }}
                    <button type="button" class="btn btn-outline-warning btn-regresar"
                     awPreviousStep>Regresar</button>
                    <button type="submit" class="btn btn-outline-success">Crear cuenta</button>
                  </aw-wizard-step>
                </aw-wizard>
                </form>
            <div class="p-20">

              <div class="progress-bar bar-progress" role="progressbar"  aria-valuemin="0" [attr.ariaValuenow]="counttimeUploading"aria-valuemax="100"
              [style.width]="counttimeUploading + '%'"> <span class="sr-only">65% Complete</span> </div>
            </div>
        </div>
    </div>
</div>
